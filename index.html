<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Family Case Tree – Sign In</title>
    <link rel="stylesheet" href="styles.css" />
    <link rel="icon" href="./images/courthouse-logo.png" />
    <meta name="description" content="Sign in to Family Case Tree or preview the app." />
    <style>
      .landing { max-width: 880px; margin: 24px auto 40px; padding: 0 16px; }
      .landing-grid { display: grid; grid-template-columns: 1fr; gap: 16px; }
      .card { background: #fff; border: 1px solid var(--border); border-radius: 12px; box-shadow: var(--shadow); padding: 16px; }
      .card h2 { margin: 0 0 8px; font-size: 18px; color: var(--brand); display: flex; align-items: center; gap: 8px; }
      .muted { color: var(--muted); font-size: 14px; margin-top: 4px; }
      .auth-form .form__row { margin-bottom: 10px; }
      .preview-points { margin: 8px 0 0; padding-left: 18px; color: var(--muted); font-size: 14px; }
      .hero-mini { display: block; width: 100%; max-height: 200px; object-fit: cover; border-radius: 10px; border: 1px solid var(--border); }
      @media (min-width: 920px) { .landing-grid { grid-template-columns: 1.1fr .9fr; } }
    </style>
  </head>
  <body>
    <header class="navbar">
      <div class="container">
        <div class="brand">
          <img src="./images/courthouse-logo.png" alt="Courthouse icon" class="logo" />
          <span class="brand-name">Family Case Tree</span>
        </div>
      </div>
    </header>

    <section class="hero" role="img" aria-label="Family tree themed banner background">
      <div class="container hero__content">
        <div class="hero__title">
          <img class="section-icon" src="./images/scales-of-justice.png" alt="Scales of justice icon" />
          <h1>Welcome</h1>
        </div>
        <p class="hero__subtitle">Sign in to access your cases or preview the app first.</p>
      </div>
    </section>

    <main class="landing">
      <div class="landing-grid">
        <section class="card auth-form" aria-label="Sign in form">
          <h2>
            <img class="section-icon" src="./images/courthouse-logo.png" alt="Courthouse" />
            Sign In
          </h2>
          <div class="form__row">
            <label for="email">Email</label>
            <input id="email" type="email" inputmode="email" autocomplete="username" placeholder="you@example.com" />
          </div>
          <div class="form__row">
            <label for="password">Password</label>
            <input id="password" type="password" autocomplete="current-password" placeholder="Password (local only)" />
          </div>
          <div class="form__actions">
            <button id="btnSignInMain" class="btn btn--primary">Sign In</button>
            <button id="btnSignUpMain" class="btn btn--secondary">Sign Up</button>
            <a href="app.html" class="btn btn--outline">Preview</a>
          </div>
          <p class="muted">Local-only: stores data on this device. No accounts are created on a server.</p>
        </section>

        <section class="card" aria-label="Preview overview">
          <h2>
            <img class="section-icon" src="./images/scales-of-justice.png" alt="Justice" />
            What you'll see in preview
          </h2>
          <img class="hero-mini" src="./images/man-in-cell.png" alt="Preview illustration" onerror="this.style.display='none'" />
          <ul class="preview-points">
            <li>Add cases: name, DOB, custody type, facility, next court date.</li>
            <li>View an ancestry-style case flow tree with stages.</li>
            <li>Highlight the current stage; update it any time.</li>
            <li>Everything saves locally; sign in later to keep data per email.</li>
          </ul>
        </section>
      </div>
    </main>

    <script>
      (function(){
        const USER_KEY = 'family-case-tree-user';
        // Auto-forward if already signed in locally, unless forced preview
        try {
          const params = new URLSearchParams(window.location.search);
          const force = params.get('force') === '1';
          if (localStorage.getItem(USER_KEY) && !force) {
            window.location.href = 'app.html';
            return;
          }
        } catch (e) {}

        function setUserAndGo() {
          const email = (document.getElementById('email').value || '').trim().toLowerCase();
          if (!email) { alert('Enter an email.'); return; }
          try { localStorage.setItem(USER_KEY, email); } catch (e) {}
          window.location.href = 'app.html';
        }
        document.getElementById('btnSignInMain').addEventListener('click', setUserAndGo);
        document.getElementById('btnSignUpMain').addEventListener('click', setUserAndGo);
      })();
    </script>
  </body>
  </html>
